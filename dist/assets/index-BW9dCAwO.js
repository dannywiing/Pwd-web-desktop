(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&u(c)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();class K{constructor(d,i=300,u=300){let a=!1,o=0,c=0,h=0,f=0,x=!1,m=0,g=0,y=!1,I=0,k=0,w=0,A=0;this.element=document.createElement("div"),this.element.style.position="absolute",this.element.style.border="2px solid black",this.element.style.background="white",this.element.style.width=i+"px",this.element.style.height=u+"px",this.element.style.boxSizing="border-box",this.element.style.overflow="hidden",this.element.style.userSelect="none",this.element.className="pwd-window",this.titlebar=document.createElement("div"),this.titlebar.style.height="24px",this.titlebar.style.background="lightgray",this.titlebar.style.display="flex",this.titlebar.style.alignItems="center",this.titlebar.style.justifyContent="space-between",this.titlebar.style.padding="0 8px",this.titlebar.style.userSelect="none",this.titlebar.className="pwd-titlebar",this.titlebar.style.flexShrink="0";const E=document.createElement("span");E.innerText=d;const B=document.createElement("button");B.className="pwd-win-btn pwd-close",B.innerText="âœ•",B.type="button",B.addEventListener("mousedown",r=>r.stopPropagation()),B.addEventListener("click",()=>{this.onClose!==void 0&&this.onClose(),this.element.remove()});const b=document.createElement("button");b.className="pwd-win-btn",b.innerHTML="â›¶",b.type="button",b.addEventListener("mousedown",r=>{r.stopPropagation()});const T=document.createElement("button");T.className="pwd-win-btn",T.innerHTML="â€•",T.type="button",T.addEventListener("mousedown",r=>{r.stopPropagation()}),T.addEventListener("click",()=>{this.element.style.display="none"});const S=document.createElement("div");S.style.display="flex",S.style.gap="6px",S.appendChild(T),S.appendChild(b),S.appendChild(B),this.titlebar.appendChild(E),this.titlebar.appendChild(S),this.content=document.createElement("div"),this.content.style.padding="10px",this.content.style.flex="1",this.content.style.minHeight="0",this.content.style.overflow="hidden",this.element.style.display="flex",this.element.style.flexDirection="column",this.element.appendChild(this.titlebar),this.element.appendChild(this.content);const p=document.createElement("div");p.className="pwd-resize-handle",p.style.position="absolute",p.style.width="14px",p.style.height="14px",p.style.right="0",p.style.bottom="0",p.style.cursor="nwse-resize",this.element.appendChild(p),p.addEventListener("mousedown",r=>{r.stopPropagation(),x=!0,o=r.clientX,c=r.clientY,m=parseInt(this.element.style.width,10),g=parseInt(this.element.style.height,10)}),this.titlebar.addEventListener("mousedown",r=>{a=!0,o=r.clientX,c=r.clientY,h=parseInt(this.element.style.left),f=parseInt(this.element.style.top)}),document.addEventListener("mousemove",r=>{if(a){const N=r.clientX-o,_=r.clientY-c;this.element.style.left=h+N+"px",this.element.style.top=f+_+"px"}if(x){const N=r.clientX-o,_=r.clientY-c,W=200,q=180,z=Math.max(W,m+N),F=Math.max(q,g+_);this.element.style.width=z+"px",this.element.style.height=F+"px"}}),document.addEventListener("mouseup",()=>{a=!1,x=!1}),b.addEventListener("click",()=>{y?(y=!1,this.element.style.left=I+"px",this.element.style.top=k+"px",this.element.style.width=w+"px",this.element.style.height=A+"px",b.innerHTML="â›¶"):(y=!0,this.element.style.left!==""?I=parseInt(this.element.style.left,10):I=0,this.element.style.top!==""?k=parseInt(this.element.style.top,10):k=0,w=this.element.offsetWidth,A=this.element.offsetHeight,this.element.style.left="0px",this.element.style.top="0px",this.element.style.width="100vw",this.element.style.height="100vh",b.innerText="ðŸ——")})}}function oe(t){t.innerHTML="";let d=4,i=4,u=[],a=[],o=[],c=!1,h=0,f=null,x=0,m=0,g="4x4",y=0,I=[];function k(){for(const e of I)clearTimeout(e);I=[]}function w(e,n,l){const s=setTimeout(()=>{l===y&&e()},n);I.push(s)}function A(e){return v.querySelector(`button.memory-card[data-index='${e}']`)}function E(e){return!(!e||e.style.visibility==="hidden"||e.disabled)}function B(){return Array.from(v.querySelectorAll("button.memory-card")).find(E)??null}function b(e){const n=v.querySelector("button.memory-card[tabindex='0']");n&&(n.tabIndex=-1),e.tabIndex=0,e.focus()}function T(){const e=t.ownerDocument.activeElement,n=e&&e.closest?e.closest("button.memory-card"):null;if(E(n))return;const l=v.querySelector("button.memory-card[tabindex='0']");if(E(l)){l.focus();return}const s=B();s&&b(s)}function S(e,n){let l=Math.floor(e/i),s=e%i;for(;;){if(n==="left"?s-=1:n==="right"?s+=1:n==="up"?l-=1:n==="down"&&(l+=1),l<0||l>=d||s<0||s>=i)return-1;const C=l*i+s,D=A(C);if(E(D))return C}}function p(e,n){const l=d*i;if(n==="right"||n==="down"){for(let s=e+1;s<l;s++){const C=A(s);if(E(C))return s}return-1}for(let s=e-1;s>=0;s--){const C=A(s);if(E(C))return s}return-1}function r(){const n=d*i/2,l=[];for(let s=1;s<=n;s++)l.push(s,s);return l}function N(e){for(let n=e.length-1;n>0;n--){const l=Math.floor(Math.random()*(n+1)),s=e[n];e[n]=e[l],e[l]=s}return e}function _(e){v.innerHTML="",v.style.display="grid",v.style.gridTemplateColumns=`repeat(${i}, 1fr)`,v.style.gap="10px";for(let l=0;l<e.length;l++){const s=document.createElement("button"),C=document.createElement("img");C.src="/img/0.png",C.alt="Card back",C.draggable=!1,s.type="button",s.tabIndex=-1,s.className="memory-card",s.dataset.index=String(l),s.appendChild(C),v.appendChild(s)}const n=B();n&&(n.tabIndex=0)}function W(e){const n=v.querySelector(`button[data-index='${e}']`);if(!n)return;const l=n.querySelector("img");l&&(l.src="/img/0.png")}function q(e){const n=v.querySelector(`button[data-index='${e}']`);n&&(n.style.visibility="hidden",n.disabled=!0,n.tabIndex=-1)}function z(e){const n=Math.floor(e/1e3),l=Math.floor(n/60),s=n%60;return`${String(l).padStart(2,"0")}:${String(s).padStart(2,"0")}`}function F(){return`memory_best_${g}`}function U(){const e=localStorage.getItem(F());if(!e){R.textContent="Best: -";return}const n=JSON.parse(e);R.textContent=`Best: ${n.attemps} attempts, ${z(n.timeMs)}`}function ne(){G(),x=Date.now(),m=0,j.textContent=`Time: ${z(0)}`,f=window.setInterval(()=>{m=Date.now()-x,j.textContent=`Time: ${z(m)}`},1e3)}function G(){f!==null&&(clearInterval(f),f=null)}function se(e,n){const l=localStorage.getItem(F());if(!l){localStorage.setItem(F(),JSON.stringify({attemps:e,timeMs:n})),U();return}const s=JSON.parse(l);(e<s.attemps||e===s.attemps&&n<s.timeMs)&&(localStorage.setItem(F(),JSON.stringify({attemps:e,timeMs:n})),U())}const H=document.createElement("button");H.className="memory-new",H.type="button",H.textContent="New game";const P=document.createElement("div");P.className="memory-attempts";const v=document.createElement("div");v.className="memory-board";const O=document.createElement("select");O.className="memory-select",O.innerHTML=`
    <option value="2x2">2x2</option>
    <option value="2x4">2x4</option>
    <option value="4x4">4x4</option>
  `;const j=document.createElement("div");j.className="memory-timer",j.textContent="Time: 00:00";const R=document.createElement("div");R.className="memory-best",R.textContent="Best: N/A",t.appendChild(H),t.appendChild(P),t.appendChild(v),t.appendChild(O),t.appendChild(j),t.appendChild(R),H.focus(),t.ownerDocument.addEventListener("keydown",e=>{const n=t.ownerDocument.activeElement;if(!t.contains(n))return;const l=e.key;if(l==="r"||l==="R"){e.preventDefault(),H.click();return}if(l==="1"){e.preventDefault(),O.value="2x2",H.click();return}if(l==="2"){e.preventDefault(),O.value="2x4",H.click();return}l==="3"&&(e.preventDefault(),O.value="4x4",H.click())},!0),v.addEventListener("keydown",e=>{const n=e.target.closest("button.memory-card");if(!n||!E(n))return;const l=Number(n.dataset.index);if(Number.isNaN(l))return;if(e.key===" "||e.key==="Enter"){e.preventDefault(),n.click();return}let s=null;if(e.key==="ArrowLeft")s="left";else if(e.key==="ArrowRight")s="right";else if(e.key==="ArrowUp")s="up";else if(e.key==="ArrowDown")s="down";else return;e.preventDefault();let C=S(l,s);if(C===-1&&(C=p(l,s)),C===-1)return;const D=A(C);E(D)&&b(D)}),v.addEventListener("click",e=>{const n=e.target.closest("button.memory-card");if(!n||(E(n)&&b(n),c)||o.length===2)return;const l=Number(n.dataset.index);if(Number.isNaN(l)||o.includes(l))return;const s=n.querySelector("img");if(!s||(s.src=`/img/${a[l]}.png`,o.push(l),o.length<2))return;c=!0,h+=1;const C=o[0],D=o[1],ie=a[C]===a[D],V=y;if(ie){w(()=>{q(C),q(D),le()&&(G(),P.textContent=`Game finished in ${h} attemps! Time: ${z(m)}`,se(h,m)),o=[],c=!1,T()},200,V);return}w(()=>{W(C),W(D),o=[],c=!1,T()},1e3,V)}),H.addEventListener("click",()=>{y+=1,k(),o=[],c=!1,h=0,P.textContent="";const e=O.value;g=e,U(),ne(),e==="2x2"?(d=2,i=2):e==="2x4"?(d=2,i=4):e==="4x4"&&(d=4,i=4),u=r(),a=N(u),_(a),T()});function le(){const e=v.querySelectorAll("button.memory-card");return Array.from(e).every(n=>n.style.visibility==="hidden")}}const Z="pwd.chat.username",ae="pwd.chat.history.",re="wss://courselab.lnu.se/message-app/socket",ce="eDBE76deU7L0H9mEBgxUKVR0VCnq0XBd",de="my, not so secret, channel";function me(t){t.innerHTML="",o();function d(c){return`${ae}${c}`}function i(c){const h=d(c),f=localStorage.getItem(h);return f===null?[]:JSON.parse(f)}function u(c,h){const f=d(c),x=JSON.stringify(h);localStorage.setItem(f,x)}function a(c,h){t.innerHTML="";const f=document.createElement("h1");f.textContent="Chat Application";const x=document.createElement("div");x.textContent="Status: Connecting...",x.className="chat-status";const m=document.createElement("div");m.className="chat-log",m.style.border="1px solid black",m.style.overflowY="auto",m.style.padding="8px",m.textContent="";const g=document.createElement("textarea");g.className="chat-input",g.rows=4,g.placeholder="Type your message...";const y=document.createElement("button");y.className="chat-send",y.type="button",y.textContent="Send";const I=document.createElement("div");I.textContent=`Channel: ${h}`;const k=document.createElement("button");k.className="chat-change",k.type="button",k.textContent="Change username";const w=document.createElement("div");w.className="chat-emoji",w.style.display="flex",w.style.gap="6px",w.style.margin="6px 0",w.style.fontFamily="Segoe UI Emoji, Apple Color Emoji, Noto Color Emoji, sans-serif",w.style.flexWrap="wrap",w.style.maxWidth="100%";const A=[128512,128514,128293,10084,128077,128526,129395,9989];for(const p of A){const r=String.fromCodePoint(p),N=document.createElement("button");N.type="button",N.textContent=r,N.addEventListener("click",()=>{g.value+=r,g.focus()}),w.appendChild(N)}const E=document.createElement("button");E.className="chat-clear",E.type="button",E.textContent="Clear history",t.appendChild(f),t.appendChild(x),t.appendChild(I),t.appendChild(k),t.appendChild(E),t.appendChild(m),t.appendChild(w),t.appendChild(g),t.appendChild(y);const B=20,b=i(h);b.length>B&&b.splice(0,b.length-B);function T(){m.innerHTML="";for(const p of b){const r=document.createElement("div");r.textContent=`${p.username}: ${p.text}`,m.appendChild(r)}m.scrollTop=m.scrollHeight}T(),E.addEventListener("click",()=>{localStorage.removeItem(d(h)),b.length=0,T()});const S=new WebSocket(re);S.addEventListener("open",()=>{x.textContent="Status: Connected"}),S.addEventListener("close",()=>{x.textContent="Status: Disconnected"}),S.addEventListener("error",()=>{x.textContent="Status: Error"}),S.addEventListener("message",p=>{const r=JSON.parse(p.data);if(r.type==="heartbeat")return;let N=r.channel;N==null&&(N=de),N===h&&(b.push({username:r.username,text:r.data}),b.length>B&&b.shift(),u(h,b),T())}),y.addEventListener("click",()=>{const p=g.value.trim();if(!p)return;const r={type:"message",data:p,username:c,channel:h,key:ce};S.send(JSON.stringify(r)),g.value=""}),g.addEventListener("keydown",p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),y.click())}),k.addEventListener("click",()=>{S.close(),o()})}function o(){t.innerHTML="";const c=document.createElement("h1");c.textContent="Choose username and channel",c.className="chat-title";const h=document.createElement("div");h.textContent="Username",h.className="chat-label";const f=document.createElement("input");f.type="text",f.placeholder="Enter your username",f.className="chat-field";const x=localStorage.getItem(Z);x!=null&&(f.value=x);const m=document.createElement("button");m.type="button",m.textContent="Start chat",m.className="chat-btn";const g=document.createElement("div");g.textContent="Channel",g.className="chat-label";const y=document.createElement("input");y.type="text",y.placeholder="Enter a channel",y.value="my, not so secret, channel",y.className="chat-field",t.appendChild(c),t.appendChild(h),t.appendChild(f),t.appendChild(g),t.appendChild(y),t.appendChild(m),m.addEventListener("click",()=>{const I=f.value.trim();if(I.length<2)return;const k=y.value.trim();k.length<2||(localStorage.setItem(Z,I),a(I,k))})}}const X="pwd.notes.content";function ue(t){t.innerHTML="";const d=document.createElement("div");d.className="notes-status",d.textContent="Status: Not saved yet";const i=document.createElement("textarea");i.className="notes-area",i.rows=12,i.placeholder="Write your notes here...",i.style.width="100%",i.style.boxSizing="border-box";const u=document.createElement("div");u.className="notes-buttons",u.style.display="flex",u.style.gap="8px",u.style.marginTop="8px";const a=document.createElement("button");a.className="notes-btn",a.type="button",a.textContent="Save";const o=document.createElement("button");o.className="notes-btn notes-danger",o.type="button",o.textContent="Clear",u.appendChild(a),u.appendChild(o),t.appendChild(d),t.appendChild(i),t.appendChild(u);const c=localStorage.getItem(X);c!==null&&(i.value=c,d.textContent="Status: Loaded saved notes");function h(){const f=i.value;localStorage.setItem(X,f);const x=new Date,m=String(x.getHours()).padStart(2,"0"),g=String(x.getMinutes()).padStart(2,"0"),y=String(x.getSeconds()).padStart(2,"0");d.textContent=`Status: Saved âœ“ (${m}:${g}:${y})`}a.addEventListener("click",()=>{h()}),o.addEventListener("click",()=>{i.value="",localStorage.removeItem(X),d.textContent="Status: Cleared",i.focus()})}let $=0,M=0;const Y=document.getElementById("app"),Q=document.getElementById("memory"),ee=document.getElementById("chat"),te=document.getElementById("notes"),L=document.createElement("div");L.className="pwd-taskbar";L.style.position="absolute";L.style.left="0";L.style.right="0";L.style.bottom="0";L.style.height="100px";L.style.background="lightgray";L.style.borderTop="2px solid black";L.style.display="flex";L.style.alignItems="center";L.style.gap="20px";L.style.padding="0 20px";L.style.boxSizing="border-box";Y.appendChild(L);Q.addEventListener("dblclick",()=>{const t=new K("Memory",600,720);oe(t.content),t.element.style.top=50+$+"px",t.element.style.left=50+$+"px",Y.appendChild(t.element),J(Q,t),$+=20,M+=1,t.element.style.zIndex=M,t.titlebar.addEventListener("mousedown",()=>{M+=1,t.element.style.zIndex=M}),Y.appendChild(t.element)});ee.addEventListener("dblclick",()=>{const t=new K("Chat",500,600);me(t.content),t.element.style.top=50+$+"px",t.element.style.left=50+$+"px",Y.appendChild(t.element),J(ee,t),$+=20,M+=1,t.element.style.zIndex=M,t.titlebar.addEventListener("mousedown",()=>{M+=1,t.element.style.zIndex=M})});te.addEventListener("dblclick",()=>{const t=new K("Notes",400,400);ue(t.content),t.element.style.top=50+$+"px",t.element.style.left=50+$+"px",Y.appendChild(t.element),J(te,t),$+=20,M+=1,t.element.style.zIndex=M,t.titlebar.addEventListener("mousedown",()=>{M+=1,t.element.style.zIndex=M}),Y.appendChild(t.element)});function J(t,d){const i=document.createElement("button");i.className="pwd-taskbar-btn",i.type="button",i.style.width="60px",i.style.height="60px",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.padding="0";const u=t.cloneNode(!0);u.classList&&u.classList.add("pwd-taskbar-icon"),u.tagName==="IMG"&&(u.style.width="200px",u.style.height="200px",u.style.objectFit="contain",u.style.pointerEvents="none"),i.appendChild(u),L.appendChild(i),i.addEventListener("click",()=>{d.element.style.display="block",M+=1,d.element.style.zIndex=M}),d.onClose=function(){i.remove()}}
